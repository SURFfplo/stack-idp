version: "3.7"
services:
  idp:
    image: 192.87.106.18:56001/nginx:0.1
    labels: 
      MY_DLO_ENVIRONMENT: development
      MY_DLO_PURPOSE: an idp
    ports:
      # platform:56000+, dev:57000+, demo:58000+, pilot:59000+
      - 57002:80
    deploy:
      replicas: 1
      restart_policy:
        condition: on-failure
    links:
      - php
    networks:
      - dev-net
    volumes:
      #- $PWD/html:/usr/share/nginx/html
      - /mnt/nfs/nfsdlo/dev-net/idp-0.1/conf:/etc/nginx/conf.d
      - /mnt/nfs/nfsdlo/dev-net/idp-0.1/html:/usr/share/nginx/html
  php:
    image: 192.87.106.18:56001/php-fpm:0.1
    deploy:
      replicas: 1
      restart_policy:
        condition: on-failure
    networks:
      - dev-net
    volumes:
      - /mnt/nfs/nfsdlo/dev-net/idp-0.1/html:/usr/share/nginx/html

networks:
  dev-net:
    external: true
